name = "auth-service"
main = "src/index.ts"
compatibility_date = "2023-12-01"

# KV 命名空间绑定
[[kv_namespaces]]
binding = "AUTH_KV"
id = "auth_kv_namespace"

[[kv_namespaces]]
binding = "TOKEN_KV"
id = "token_kv_namespace"

[[kv_namespaces]]
binding = "SESSION_KV"
id = "session_kv_namespace"

# 环境变量（开发环境示例）
[vars]
JWT_SECRET = "dev-secret-change-in-production"
JWT_ACCESS_EXPIRES_IN = "15m"
JWT_REFRESH_EXPIRES_IN = "7d"
OAUTH_CLIENT_SECRET = "dev-oauth-secret"

[env.production]
name = "auth-service-prod"

# 生产环境 KV 命名空间
[[env.production.kv_namespaces]]
binding = "AUTH_KV"
id = "auth_kv_namespace_prod"

[[env.production.kv_namespaces]]
binding = "TOKEN_KV"
id = "token_kv_namespace_prod"

[[env.production.kv_namespaces]]
binding = "SESSION_KV"
id = "session_kv_namespace_prod"

# 生产环境变量（通过 wrangler secret 设置敏感信息）
# wrangler secret put JWT_SECRET
# wrangler secret put OAUTH_CLIENT_SECRET
[env.production.vars]
JWT_ACCESS_EXPIRES_IN = "15m"
JWT_REFRESH_EXPIRES_IN = "7d"

[env.development]
name = "auth-service-dev"

# 开发环境 KV 命名空间
[[env.development.kv_namespaces]]
binding = "AUTH_KV"
id = "auth_kv_namespace_dev"

[[env.development.kv_namespaces]]
binding = "TOKEN_KV"
id = "token_kv_namespace_dev"

[[env.development.kv_namespaces]]
binding = "SESSION_KV"
id = "session_kv_namespace_dev"

[env.development.vars]
JWT_SECRET = "dev-secret-change-in-production"
JWT_ACCESS_EXPIRES_IN = "15m"
JWT_REFRESH_EXPIRES_IN = "7d"
OAUTH_CLIENT_SECRET = "dev-oauth-secret"
